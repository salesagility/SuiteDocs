---
Title: Процессы
Weight: 240
---

:author: likhobory
:email: likhobory@mail.ru

:toc:
:toc-title: Оглавление
:toclevels: 5

:experimental:   

:imagesdir: ./../../../../images/ru/user/advanced-modules/Workflow

ifdef::env-github[:imagesdir: ./../../../../master/static/images/ru/user/advanced-modules/Workflow]

:btn: btn:

ifdef::env-github[:btn:]

= Процессы

Данный модуль позволяет  автоматически совершать различные действия при добавлении/изменении данных в системе, а также по расписанию 
link:../../../admin/administration-panel/system/#_Планировщик[планировщика], настроенному в панели Администрирования.

image:image1.png[Процессы]
  
В текущей версии поддерживаются следующие действия: 

*	создание записи
*	изменение записи
*	отправка E-mail
*	вычисления в полях

{{% notice note %}}
Совершение действия при *удалении* записи не поддерживается.
{{% /notice %}}

== Создание процесса

 .	В меню модуля выберите опцию *Создать процесс*.
 .	В  верхней части Формы редактирования заполните следующие поля:

image:image2.png[Создание процесса]

Процесс:: Укажите название процесса.
Ответственный(ая):: Введите имя ответственного. По умолчанию ответственным являетесь вы. Для назначения другого пользователя нажмите кнопку   и из появившегося списка выберите желаемого пользователя. 
Контролируемый модуль:: Список всех доступных модулей системы. Выберите необходимый модуль, при создании/изменении записи которого должен запускаться создаваемый Процесс.
Статус:: Укажите статус Процесса. Выполняться будут только активные процессы.
Запускать:: Укажите условие запуска – *Всегда*, *Только при сохранении записи*, либо *Только в рабочее время*. В последнем случае должен быть настроен 
link:../../../admin/administration-panel/advanced-openadmin/#_Настройка_графика_работы[график работы организации].
Запускать для::  Процесс может запускаться для ВСЕХ записей, только для СОЗДАВАЕМЫХ записей, либо только для ИЗМЕНЯЕМЫХ записей.
Многократный запуск::  Многократный запуск процесса актуален  в том случае, когда одно из указанный действий Процесса «сводит на нет» одно из указанных условий запуска Процесса. 
Описание:: Введите краткое описание Процесса.

=== Условия выполнения процесса 

[start=3]
 . В средней части Формы редактирования заполните условия выполнения Процесса. Создание условий доступно только после указания контролируемого модуля.

Нажмите на кнопку {btn}[Добавить условие] и введите необходимые данные.Количество добавляемых условий не ограничено. 

В следующем примере добавляется условие для модуля *Встречи* - процесс будет запущен в том случае, если тема встречи содержит слово *совещание*:

image:image3.png[Условия выполнения процесса]

Детально каждое заполняемое поле описано ниже:

Модуль:: Укажите модуль, для которого должно выполняться создаваемое условие.
Поле:: Выберите из списка необходимое поле указанного модуля.
Оператор сравнения:: В зависимости от выбранного поля доступны различные операторы сравнения. Если поле НЕ содержит дату или цифровое значение, то доступны следующие операторы: *Равно*, *Не равно*, *Содержит*, *Начинается с*, *Оканчивается на*, *Пустое*. Если поле цифровое или содержит дату, то возможны следующие условия: *Равно*, *Не равно*, *Больше*, *Меньше*, *Больше или равно*, *Меньше или равно*, *Пустое*.

{{% notice note %}}
Тип поля не всегда может соответствовать его названию. Например, в модуле *Контрагенты* стандартное поле *Число сотрудников* указано не как целочисленное, а как текстовое. Типы доступных полей модуля вы можете просмотреть в Студии. Тип ранее созданного поля в Студии изменить нельзя, но администратор системы может создать link:../../../admin/administration-panel/developer-tools/#_Создание_и_редактирование_полей[новое поле] с требуемым типом и добавить его в макет соответствующей Формы.
{{% /notice %}}

Тип::  Тип условия, в зависимости от типа выбранного поля доступны следующие варианты: 
*	*_Значение_* – наиболее частый вариант, используется для сравнения выбранного поля с указанным значением.  Значение может быть представлено по-разному, в зависимости от типа выбранного поля. Например, если поле представлено комбобоксом, то  значение будет представлено списком:

image:image4.png[Значение]

*	*_Поле_* – используется для сравнения значения двух полей. В следующем примере сравниваются даты создания и изменения записи:
 
image:image5.png[Поле]

*	*_Изменение_*  - используется при изменении значения выбранного поля. Например, в следующем примере Процесс будет запущен, если был изменён тип Контрагента:

image:image6.png[Изменение]

*	 *_Мультивыбор_*  - используется для сравнения выбранного поля с несколькими значениями. Например, в следующем примере Процесс будет запущен, если отрасль Контрагента соответствует одному из выбранных значений:

image:image7.png[Мультивыбор]

*	*_Дата_* - используется для сравнения выбранного поля с указанной датой или интервалом. Интервал может быть представлен минутами, часами, днями, неделями, месяцами или годовщиной.

{{% notice note %}}
Если годовщина приходится на 29 февраля, но текущий год не является високосным, то Процесс будет запущен 28 февраля.
{{% /notice %}}

Например, в следующем примере Процесс будет запущен, если запись о Контрагенте была создана в течение ближайших 6 дней:

image:image8.png[Дата]

[discrete]
=== Удаление условия процесса

Для удаления ранее  созданного условия нажмите на соответствующий значок, расположенный слева от условия:

image:image9.png[Удаление условия процесса]


=== Действия

[start=4]
 .	В нижней части Формы редактирования Процесса настройте действия, которые будут выполнены, если есть соответствие ранее указанным условиям. 
Нажмите на кнопку {btn}[Добавить действие] и выберите необходимое значение. Доступны следующие действия: *Создать запись*, *Изменить запись*, *Отправить E-mail* и *Выполнить вычисления в полях*. 

image:image10.png[Действия]

Для каждого действия желательно указать его краткое описание (или название). Количество добавляемых в Процесс действий не ограничено.

==== Создание записи 

Прежде всего необходимо выбрать тип записи - модуль, в котором будет создаваться необходимая запись. 

После выбора модуля вы можете:

*	Связать создаваемую запись с записью в контролируемом модуле, отметив соответствующую опцию. В этом случае в субпанелях Форм просмотра обеих записей будет отображаться информация о созданной связи.

* Скопировать электронные адреса из контролируемого модуля в связанный модуль, отметив соответствующую опцию. Для копирования должна быть отмечена и предыдущая опция.

image:image11.png[Связать с записью в контролируемом модуле]
 
*	Связать создаваемую запись с другой записью. Для этого нажмите кнопку {btn}[Добавить связь], выберите необходимый модуль и существующую в нем запись. На рисунке ниже показан пример, где создаваемая задача с темой *Моя задача* будет связана с записью *Judy Perna* из модуля Контакты: 

image:image12.png[Связать с другой записью]

*	Указать поля, которые необходимо заполнить при создании записи. Для этого нажмите кнопку {btn}[Добавить поле] и выберите необходимый элемент в списке.

image:image13.png[Указать заполняемые поля]

После этого справа появится ещё один список, позволяющий указать, каким именно образом будет заполняться поле создаваемой записи. Доступны следующие варианты:

*_Значение_* – поле создаваемой записи будет содержать указанное значение

*_Поле_* – поле создаваемой записи будет содержать то же значение, что и выбранное поле

*_Дата_* – доступно только если поле имеет тип *Date* - поле будет содержать указанное или вычисляемое по указанной формуле значение даты

Для поля *Ответственный(ая)* доступны дополнительные варианты:

*_Назначение в цикле_* – пользователи выбираются по порядку (из общего списка, из Роли и/или из Группы)

*_Назначение наименее занятого_* – выбирается пользователь, у которого меньше всего записей в текущем модуле (выбор из общего списка, из Роли и/или из Группы)

*_Случайное назначение_* – выбор случайного пользователя (из общего списка, из Роли и/или из Группы)

{{% notice info %}}
Детальная информация о Ролях  и Группах описана в разделе 
link:../../../admin/administration-panel/users/#_Роли_и_группы_пользователей[Роли и группы пользователей].
{{% /notice %}}

В указанном ниже примере создаётся запись в модуле *Задачи* со следующими заполненными полями:

Тема задачи:: *Моя задача*
Дата создания:: Текущая дата + 10 минут
Дата изменения:: Равна дате создания
Ответственный(ая):: Назначается в цикле из Группы *group1* и из Роли *role1*

image:image14.png[Пример создания записи]

==== Изменение записи

В данном случае используется тот же функционал, что и при создании записи, но вместо создания новой записи происходит изменение уже существующей: могут быть изменены значения полей записи, добавлены связи с другими записями.

==== Отправка E-mail


В данном случае выполнение Процесса приведёт к отправке на указанные адреса электронных писем, созданных на основе 
link:../../core-modules/emailtemplates[шаблонов]. Для отправки писем индивидуально каждому пользователю – отметьте соответствующую опцию, в противном случае каждый получатель будет видеть адресные данные всех указанных адресатов.

image:image15.png[Отправка E-mail]

При указании адресатов возможны следующие варианты:

*	*_Указать вручную_* – E-mail вводится вручную
*	*_Отобранной записи_* –  E-mail будет отправлен на основной электронный адрес записи, запустившей текущий Процесс. Данный вариант может быть задействован только в том случае, если в записи есть поле с электронным адресом (для Контактов, Контрагентов и т.д.)
*	*_Связанной записи_* – E-mail будет отправлен на основной электронный адрес записи, связанной с текущей. Для того из комбобокса выберите соответствующий модуль, связанный с текущим
*	*_Выбрать пользователя_* – E-mail будет отправлен на электронный адрес выбранного пользователя
*	*_Выбрать пользователей_* – E-mail будет отправлен на электронный адрес всех пользователей, пользователей Роли и/или пользователей Группы.

{{% notice info %}}
Детальная информация о Ролях  и Группах описана в разделе 
link:../../../admin/administration-panel/users/#_Роли_и_группы_пользователей[Роли и группы пользователей].
{{% /notice %}}

==== Вычисления в полях
 
См. раздел link:../workflow-calculated-fields[Вычисления в полях процессов]

==== Удаление действия

Для удаления ранее созданного действия нажмите на соответствующий значок, расположенный в правом верхнем углу действия: 

image:image21.png[Удаление действия]

Для удаления записи внутри действия нажмите на соответствующий значок, расположенный слева от записи:

image:image22.png[Удаление записи внутри действия]

== Контроль процесса

В нижней части Формы просмотра каждого процесса расположена субпанель *Контроль процесса*, отображающая  информацию о выполнении текущего процесса, содержащую в том числе: название записи, запустившей  процесс, статус выполнения процесса, дату и время выполнения процесса.

image:image23.png[Контроль процесса]
 
== Управление информацией о процессах

[discrete]
==== В модуле вы можете выполнять следующие действия:

*	Сортировка списка записей, для этого нажмите на значок   в заголовке сортируемого столбца, для обратной сортировки нажмите на значок ещё раз. 
*	Добавление записи в избранное –  после чего пользователь получает возможность быстрого доступа к наиболее важной для него информации. За дополнительной информацией  обратитесь к разделу link:../../introduction/user-interface/#_Избранное[Избранное].
*	Редактирование или удаление информации сразу о нескольких процессах,  для этого используйте link:../../introduction/user-interface/#_Массовое_обновление_или_удаление_записей[панель массового обновления].
*	link:../../introduction/user-interface/#_Экспорт_данных[Экспорт] записей, для этого в меню над выбранными записями выберите пункт *Экспортировать*.
*	link:../../introduction/user-interface/#_Поиск_и_объединение_схожих_записей[Поиск дубликатов], для этого в меню действий Формы просмотра выберите пункт *Поиск дубликатов*..
*	Просмотр детальной информации о процессе, для этого нажмите на названии процесса в общем списке.
*	Редактирование данных, для этого  либо в Форме просмотра нажмите на кнопку {btn}[Править], либо непосредственно в Форме списка нажмите на кнопку   слева от редактируемой записи. Вы также можете выполнить link:../../introduction/user-interface/#_Быстрая_правка[быструю правку].
*	Дублирование информации о процессе, для этого в меню действий выберите пункт {btn}[Дублировать]. Дублирование является удобным способом быстрого создания схожих записей, вы можете изменить продублированную информацию с целью создания нового процесса.
*	Удаление процесса, для этого нажмите на кнопку {btn}[Удалить]. 
*	Отслеживание изменений введённой информации, для этого нажмите на кнопку {btn}[Просмотр журнала изменений] в форме просмотра. Если в журнале необходимо изменить перечень контролируемых полей - сделайте это в Студии, настроив параметр link:../../../admin/administration-panel/developer-tools/#Audit[*Аудит*] соответствующего поля.

== Примеры процессов 

=== Добавление клиентов в список адресатов

В данном примере показано пошаговое создание процесса, автоматически добавляющего  Контрагентов, имеющих тип *Клиенты*, в список адресатов при создании или изменении информации о Контрагенте: 

 .	В модуле процессы выбираем действие *Создать процесс*.
 .	Присваиваем процессу подходящее название, например: «Заполнение списка адресатов». 
 .	В списке контролируемых модулей выбираем модуль *Контрагенты*. 
 .	В списке *Запускать* выбираем значение *Только при сохранении записи*.
 .	В списке *Запускать для* оставляем стандартное значение *Всех записей* - в этом случае процесс будет запущен и при создании, и при изменении записи.
 .	Убеждаемся, что опция *Многократный запуск* НЕ отмечена и статус указан как *Активен*. При необходимости вводим описание процесса и указываем ответственного.

[discrete]
==== Добавление условий 

 .	В разделе условий выполнения процесса нажимаем кнопку {btn}[Добавить условие]. 
 .	В списке полей выбираем значение *Тип* 
 .	В качестве оператора сравнения оставляем значение *Равно*, в поле *Тип* выбираем *Значение*. 
 .	В списке значений выбираем *Клиент*.
 
Созданное условие должно выглядеть следующим образом:

image:image24.png[Примеры процессов1-Добавление условий]

[discrete]
==== Добавление действий

 .	В разделе действий нажимаем кнопку {btn}[Добавить действие]. 
 .	В списке действий выбираем *Изменить запись*.
 .	В поле *Краткое описание действия* вводим соответствующее название, например: «Дополнение списка адресатов».
 .	Нажимаем кнопку {btn}[Добавить связь]. 
 .	В появившемся над кнопкой списке выбираем значение *Списки адресатов: Адресаты*.
 .	Появятся два дополнительных поля. В крайнем правом поле указываем необходимый список адресатов. 
Созданное действие  будет выглядеть следующим образом: 

image:image25.png[Примеры процессов1-Добавление действий]

=== Уведомление о поступивших обращениях

В данном примере показано пошаговое создание процесса, автоматически отправляющего уведомления двум пользователям (ответственному за обращение и дополнительно указанному пользователю) в том случае, если открытое обращение не обновлялось в течение двух дней:  

 .	В модуле процессы выбираем действие *Создать процесс*
 .	Присваиваем процессу подходящее название, например: «Напоминание об обращении». 
 .	В списке контролируемых модулей выбираем модуль *Обращения*. 
 .	В списке *Запускать* выбираем значение *Только при сохранении записи*.
 .	В списке *Запускать для* оставляем стандартное значение *Всех записей* - в этом случае процесс будет запущен и при создании, и при изменении записи.
 .	Убеждаемся, что опция *Многократный запуск* НЕ отмечена и статус указан как *Активен*. При необходимости вводим описание процесса и указываем ответственного.

[discrete]
==== Добавление условий 

 .	В разделе условий выполнения процесса нажимаем кнопку {btn}[Добавить условие]. 
 .	В списке полей выбираем значение *Дата изменения* 
 .	В качестве оператора сравнения выбираем значение *Меньше или равно*, в поле *Тип* выбираем значение *Дата*. 
 .	В списке значений выбираем *Сейчас* и в дополнительных полях указываем: «-», «2» и «дней».  
 .	Ещё раз нажимаем кнопку {btn}[Добавить условие]. 
 .	В списке полей нового условия выбираем значение *Статус*.
 .	В качестве оператора сравнения оставляем значение *Равно*, в поле *Тип* выбираем *Мультивыбор*. 
 .	В списке значений выбираем элементы, соответствующие открытому обращению, в данном случае это *Новое* и *Назначенное*.
 
Созданное условие должно выглядеть следующим образом. 

image:image26.png[Примеры процессов2-Добавление условий]

[discrete]
==== Добавление действий 

 .	В разделе действий нажимаем кнопку {btn}[Добавить действие]. 
 .	В списке действий выбираем *Отправить E-mail*.
 .	В поле *Краткое описание действия* вводим соответствующее название, например: «Напоминание пользователям об обращении».
 .	Отмечаем необязательную опцию *Отправлять индивидуально каждому указанному адресату* - в этом случае каждый адресат будет видеть в списке получателей письма только свой электронный адрес.
 .	Нажмите на кнопку   и для поля *Кому* выберите значение *Связанной записи*, после чего в крайнем правом поле выберите значение *Пользователи: Ответственный(ая)*.
 .	Нажмите на кнопку   ещё раз и для нового поля *Кому* выберите значение *Выбрать пользователя*, после чего в крайнем правом поле выберите необходимого дополнительного пользователя.
 .	В списке шаблонов электронных писем выберите подходящий  шаблон или создайте новый.
 
Созданное действие  будет выглядеть следующим образом: 

image:image27.png[Примеры процессов2-Добавление действий]

=== Назначение Предварительного контакта пользователю, входящего в указанную группу

В данном примере показано пошаговое создание процесса, автоматически выполняющего следующие действия:

*	Назначение зарегистрированного через  веб-форму Предварительного контакта наименее занятому пользователю, входящего в условную Группу «group1» (выбирается пользователь, у которого меньше всего записей в модуле *Предварит. Контакты*)
*	Назначение звонка пользователю с указанием времени звонка на сутки позже после создания Предварительного контакта
 
 .	В модуле процессы выбираем действие *Создать процесс*
 .	Присваиваем процессу подходящее название, например: «Назначение ответственного предварительному контакту + звонок». 
 .	В списке контролируемых модулей выбираем модуль *Предварит. Контакты*. 
 .	В списке *Запускать* выбираем значение *Только при сохранении записи*.
 .	В списке *Запускать для* выбираем значение *Создаваемых записей*.
 .	Убеждаемся, что опция *Многократный запуск* НЕ отмечена и статус указан как *Активен*. При необходимости вводим описание процесса и указываем ответственного.

[discrete]
==== Добавление условий 

 .	В разделе условий выполнения процесса нажимаем кнопку {btn}[Добавить условие]. 
 .	В списке полей выбираем значение *Источник предв. контакта* 
 .	В качестве оператора сравнения оставляем значение *Равно*, в поле *Тип* выбираем *Значение*. 
 .	В списке значений выбираем *Веб-сайт*.
 
Созданное условие должно выглядеть следующим образом:

image:image28.png[Примеры процессов3-Добавление условий]

[discrete]
==== Добавление действий
 
 .	В разделе действий нажимаем кнопку {btn}[Добавить действие]. 
 .	В списке действий выбираем *Изменить запись*.
 .	В поле *Краткое описание действия* вводим соответствующее название, например: «Назначение ответственного наименее занятому предварительному контакту».
 .	В списке *Тип записи* выбираем модуль *Предварит. Контакты*.
 .	Нажимаем кнопку {btn}[Добавить поле].
 .	В появившемся над кнопкой списке выбираем значение *Ответственный(ая)*.
 .	Появятся два дополнительных поля. В среднем поле выбираем *Назначение наименее занятого*.
 .	В крайнем правом поле выбираем *ВСЕ пользователи Группы*.
 .	В появившемся справа поле выбираем группу «group1».
 .	Ещё раз нажимаем кнопку {btn}[Добавить действие].
 .	В списке действий выбираем *Создать запись*.
 .	В поле *Краткое описание действия* вводим соответствующее название, например: «Назначение звонка».
 .	В списке *Тип записи* выбираем модуль *Звонки*.
 .	Отмечаем опцию *Связать с записью в контролируемом модуле*.
 .	Нажимаем кнопку {btn}[Добавить поле].
 .	В появившемся над кнопкой списке выбираем значение *Дата звонка*.
 .	Появятся два дополнительных поля. В среднем поле выбираем *Дата*.
 .	В крайнем правом поле выбираем *Сегодня*.
 .	В появившихся дополнительных полях  указываем следующие значения: «+», «1», и «дней».
 .	Нажимаем кнопку {btn}[Добавить поле].
 .	В появившемся над кнопкой списке выбираем значение *Ответственный(ая)*.
 .	Появятся два дополнительных поля. В среднем поле выбираем *Поле*.
 .	В крайнем правом поле выбираем Ответственный(ая)» - при этом создаётся связь между назначенным  ответственным Предварительного контакта и звонком.

Созданные  действия  будут выглядеть следующим образом: 

image:image29.png[Примеры процессов3-Добавление действий]

 