---
Title: Использование мастера обновления
Weight: 40
---

:author: likhobory
:email: likhobory@mail.ru

:toc:
:toc-title: Оглавление
:toclevels: 3

:experimental:

:imagesdir: /images/ru/admin/UpgradeWizard

ifdef::env-github[:imagesdir: ./../../../../master/static/images/ru/admin/UpgradeWizard]

:btn: btn:

ifdef::env-github[:btn:]

= Использование мастера обновления

Перед обновлением убедитесь, что файл *_config.php_*, расположенный в корневой папке системы, доступен для записи.
 
{{% notice note %}}
Обновление системы вручную (путём замены файлов системы  и выполнения скриптов SQL) не поддерживается.
{{% /notice %}}

== Мастер обновления

Для обновления системы при помощи мастера обновления выполните следующее: ::
 .	Загрузите файл обновления с сайта SuiteCRM: https://suitecrm.com/upgrade-suitecrm
 .	Войдите в обновляемую систему под учётной записью администратора и в панели администрирования перейдите в раздел *_Мастер обновления_*.
 
image:image1.png[]

[start=3]
 .	После ознакомления со стартовой страницей мастера нажмите на кнопку {btn}[Вперёд]. Вы перейдёте на страницу проверки системы. В случае возникновения проблем с правами доступа к файлам или с настройками системы – вы увидите соответствующие предупреждения. Устраните возникшие проблемы и нажмите на кнопку {btn}[Проверить].

image:image2.png[]
 
[start=4] 
 .	Если проверка пройдена успешно – нажмите на кнопку {btn}[Вперёд] для перехода на страницу загрузки пакета обновления.

image:image3.png[]

[start=5] 
 .	Нажмите на кнопку {btn}[Обзор] и укажите путь к пакету обновления.
 .	Нажмите на кнопку {btn}[Загрузка пакета]. 
 .	После успешной загрузки пакета нажмите на кнопку {btn}[Вперёд] для перехода на страницу предварительной проверки.

image:image3a.png[]

В случае различия структуры баз данных между текущей и загружаемой версиями системы – вы можете просмотреть соответствующий скрипт, изменяющий структуру текущей БД.  

По умолчанию SQL-запрос выполняется мастером обновления. Если вы хотите выполнить запрос вручную, то из выпадающего списка выберите пункт  *_Выполнение SQL-запроса вручную_* и отметьте опцию *_Проверять, когда запрос был выполнен вручную_*. 

При необходимости вторичной проверки нажмите на кнопку {btn}[Проверить], если проверка пройдена успешно, нажмите на кнопку {btn}[Вперёд] для выполнения основного этапа обновления. После выполнения обновления вы можете просмотреть скопированные файлы.

image:image4.png[]

[start=8] 
 .	Нажмите кнопку {btn}[Вперёд].
 .	В процессе обновления системы выполняется объединение трёх типов макетов модулей: изменённых пользователями макетов старого экземпляра системы, стандартных макетов старого экземпляра системы и стандартных макетов нового экземпляра системы. Если в новых макетах предполагаются новые стандартные поля (и аналогичные поля не были добавлены ранее в старые макеты через Студию или другим *_upgrade-safe_* способом), то эти поля будут добавлены в соответствующие старые обновляемые макеты. Также если в обновлённых макетах предполагается новое расположение стандартных полей (и это расположение не было изменено ранее в старых макетах через Студию), то обновление приведёт к новому расположению полей в обновляемых макетах.
 
Таким образом, если старые макеты модулей были изменены пользователями, а в новых макетах были добавлены новые или перемещены прежние стандартные поля, то на следующем шаге обновления будет отображена страница обновления макетов, на которой будут перечислены все макеты, которые будут подвергнуты изменениям в новой версии системы.
Вы можете снять отметки с тех макетов, которые вы хотите оставить без изменений. По умолчанию отмечены все обновляемые макеты. При необходимости вы  можете позже самостоятельно внести необходимые изменения через Студию.

Например, в Формы просмотра/редактирования Заметок, а также в Шаблоны E-mail добавлено новое стандартное поле *_Ответственный(ая)_*. Если в обновляемой системе Форма редактирования Заметок уже была изменена пользователями, но стандартные Шаблоны E-mail осталась без изменений, то на странице обновления макетов будут перечислены макеты только Формы просмотра и Формы редактирования Заметок, стандартные Шаблоны E-mail перечислены не будут.

[start=10]
 .	Нажмите кнопку {btn}[Вперёд]. Если на предыдущем шаге были указаны макеты модулей, подлежащие обновлению, то появится сообщение, подтверждающее, что макеты были успешно обновлены.
 .	Нажмите кнопку {btn}[Вперёд] для перехода к заключительному этапу обновления. Если ранее было выбрано ручное выполнение SQL-запросов, то оно должно быть выполнено на данном этапе. 
 .	Нажмите на кнопку {btn}[Готово], после чего откроется основная страница системы.
 .	В панели администрирования перейдите в раздел *_Восстановление_* и выполните перестройку расширений и перестройку связей. Более подробная информация находится в разделе 
link:../../administration-panel/system/#_восстановление[Восстановление].

{{% notice note %}}
Если процесс обновления завершился неудачно, обратитесь к файлу *_upgradeWizard.log_*, расположенному в корневой папке системы.
{{% /notice %}}

== Обновление импортированных писем

Описанные ниже действия актуальны при обновлении системы с версий 7.8.х или более ранних.

{{% notice note %}}
В версии 7.9 и более поздних изменился алгоритм хранения почтовых данных. Если в предыдущих версиях почтовые данные кэшировались в системе (использовалась таблица email_cache), то теперь SuiteCRM напрямую взаимодействует с почтовым сервером, избавляясь от необходимости синхронизации информации и значительно сокращая объём почтовых данных, сохраняемых в базе данных. 
{{% /notice %}}

Для обновления ранее импортированных в систему писем выполните следующее: ::

 .	В панели Администрирования выберите пункт menu:Восстановление[Синхронизация учётных записей входящей почты].
 .	Выберите необходимую учётную запись (или несколько записей) входящей почты и нажмите на кнопку {btn}[Синхронизировать].
 
Если в процессе синхронизации возникнут ошибки, то информация о них будет сохранена в файле *_suitecrm.log_*.

== Блокировка мастера обновления

Если вы управляете несколькими экземплярами SuiteCRM и хотите сохранять полный контроль над ними, то вы можете заблокировать мастер обновления с той целью, чтобы другие пользователи с правами администратора не могли бы обновить ни один из экземпляров системы. +
Для этого:

 .	Откройте файл *_config.php_* в текстовом редакторе.
 .	Отредактируйте нижеследующий параметр: `$sugar_config['admin_access_control']=true`
 .	Сохраните файл конфигурации.
